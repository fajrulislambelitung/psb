<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulir Wali - PSB 2026</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f0f2f5;
        }

        /* HEADER */
        .hero-header {
            background: linear-gradient(135deg, #0d6efd 0%, #0a58ca 100%);
            padding: 50px 20px 80px 20px;
            color: white;
            text-align: center;
            border-bottom-left-radius: 40px;
            border-bottom-right-radius: 40px;
        }

        /* CONTAINER */
        .form-container {
            max-width: 800px;
            margin: -60px auto 40px auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            padding: 25px;
        }

        /* SECTION STYLING */
        .section-title {
            display: flex;
            align-items: center;
            font-weight: 600;
            color: #0d6efd;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px dashed #e9ecef;
        }
        .section-icon {
            width: 35px;
            height: 35px;
            background: #e7f1ff;
            color: #0d6efd;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 1.1rem;
            flex-shrink: 0;
        }

        .section-danger .section-title { color: #dc3545; }
        .section-danger .section-icon { background: #f8d7da; color: #dc3545; }

        /* INPUTS */
        .form-control, .form-select {
            border-radius: 10px;
            padding: 12px;
            border: 1px solid #ced4da;
        }
        .form-control:focus, .form-select:focus {
            border-color: #0d6efd;
            box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);
        }

        /* LABEL TANYA (Perbaikan Responsif) */
        .label-tanya {
            display: block;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
            line-height: 1.4;
        }

        .btn-submit {
            background: linear-gradient(135deg, #0d6efd 0%, #0b5ed7 100%);
            border: none;
            border-radius: 50px;
            padding: 15px;
            font-weight: 600;
            box-shadow: 0 5px 15px rgba(13, 110, 253, 0.3);
        }
    </style>
</head>
<body>

    <div class="hero-header">
        <h2 class="fw-bold mb-1">Komitmen Wali</h2>
        <p class="opacity-75">Data ini sebagai dasar akad pengasuhan.</p>
    </div>

    <div class="form-container">
        <form id="formWali">
            
            <div class="mb-5">
                <div class="section-title">
                    <div class="section-icon"><i class="bi bi-people-fill"></i></div>
                    A. Data Wali & Santri
                </div>

                <div class="mb-3">
                    <label class="label-tanya text-muted small">NAMA ORANG TUA / WALI</label>
                    <div class="input-group">
                        <span class="input-group-text bg-light"><i class="bi bi-person-check"></i></span>
                        <input type="text" id="namaWali" class="form-control" placeholder="Nama Bapak/Ibu" required>
                    </div>
                </div>

                <div class="row g-3">
                    <div class="col-md-6">
                        <label class="label-tanya text-muted small">NAMA CALON SANTRI</label>
                        <div class="input-group">
                            <span class="input-group-text bg-light"><i class="bi bi-person-badge"></i></span>
                            <select id="namaAnak" class="form-select" required>
                                <option value="" disabled selected>-- Pilih Nama Anak --</option>
                                <option value="Alexy Pratama Hadrian">Alexy Pratama Hadrian</option>
                                <option value="Amin Sugiono">Amin Sugiono</option>
                                <option value="Fatir Al Muqminun Hakim">Fatir Al Muqminun Hakim</option>
                                <option value="Fadhilah Afkhar">Fadhilah Afkhar</option>
                                <option value="Ghifar Tri Mulia">Ghifar Tri Mulia</option>
                                <option value="Ilham Maulana">Ilham Maulana</option>
                                <option value="Medika Pratama">Medika Pratama</option>
                                <option value="Muhammad Al Awin">Muhammad Al Awin</option>
                                <option value="Muhammad Bilal Arifi">Muhammad Bilal Arifi</option>
                                <option value="Rifki Ahnaf">Rifki Ahnaf</option>
                                <option value="Muhammad Afif Al Baihaqi">Muhammad Afif Al Baihaqi</option>
                                <option value="Muhammad Nabil Irwansyah">Muhammad Nabil Irwansyah</option>
                                <option value="M. Umar Halim Rahmaputra">M. Umar Halim Rahmaputra</option>
                                <option value="Riki Wardani">Riki Wardani</option>
                                <option value="Riko Wardana">Riko Wardana</option>
                                <option value="Nami Ria Ramadhani">Nami Ria Ramadhani</option>
                                <option value="Naeva Marnia">Naeva Marnia</option>
                                <option value="Nabila Nur Wamawadda Al-Maira">Nabila Nur Wamawadda Al-Maira (Menyusul)</option>
                                <option value="Najiha Shafiyah Afifah">Najiha Shafiyah Afifah (Menyusul)</option>
                                <option value="Qonita Azzahrah Alfanyuri">Qonita Azzahrah Alfanyuri (Menyusul)</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <label class="label-tanya text-muted small">NO. WHATSAPP AKTIF</label>
                        <div class="input-group">
                            <span class="input-group-text bg-light"><i class="bi bi-whatsapp"></i></span>
                            <input type="tel" id="waWali" class="form-control" placeholder="08xxxxx" required>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mb-5 section-danger">
                <div class="section-title">
                    <div class="section-icon"><i class="bi bi-heart-pulse-fill"></i></div>
                    B. Riwayat Kesehatan & Perilaku
                </div>
                
                <div class="alert alert-warning border-0 d-flex align-items-center mb-3" role="alert">
                    <i class="bi bi-exclamation-triangle-fill me-2 fs-4"></i>
                    <div class="small">
                        Mohon isi dengan <b>JUJUR</b>. Menyembunyikan riwayat penyakit berat dapat membahayakan nyawa Ananda di pondok.
                    </div>
                </div>

                <div class="mb-3">
                    <label for="penyakit" class="label-tanya">Apakah ada riwayat sakit berat? (Asma, Kejang, Maag Akut, Alergi, dll)</label>
                    <textarea class="form-control bg-light" id="penyakit" rows="2" placeholder="Tulis '-' jika sehat"></textarea>
                </div>

                <div class="mb-3">
                    <label for="pelanggaran" class="label-tanya">Riwayat pelanggaran di sekolah lama? (Jujur lebih baik)</label>
                    <textarea class="form-control bg-light" id="pelanggaran" rows="2" placeholder="Contoh: Merokok, Bolos, atau 'Bersih'"></textarea>
                </div>
            </div>

            <div class="mb-5">
                <div class="section-title">
                    <div class="section-icon"><i class="bi bi-briefcase-fill"></i></div>
                    C. Komitmen Pengasuhan
                </div>

                <div class="mb-4">
                    <label class="label-tanya">Apa motivasi utama memasukkan anak ke sini?</label>
                    <div class="card p-3 border-0 bg-light">
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="radio" name="motivasiWali" id="m1" value="VisiMisi" required>
                            <label class="form-check-label" for="m1">Visi Misi Pesantren (Ingin anak sholeh)</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="radio" name="motivasiWali" id="m2" value="Mandiri">
                            <label class="form-check-label" for="m2">Agar anak Mandiri/Disiplin</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="motivasiWali" id="m3" value="BiayaLokasi">
                            <label class="form-check-label" for="m3">Faktor Biaya Terjangkau / Lokasi Dekat</label>
                        </div>
                    </div>
                </div>

                <div class="row g-3">
                    <div class="col-md-6">
                        <label class="label-tanya text-muted small">KESIAPAN KEUANGAN (SPP)</label>
                        <select id="keuangan" class="form-select" required>
                            <option value="Sanggup">Sanggup Bayar Tepat Waktu</option>
                            <option value="ButuhBicara">Butuh Pembicaraan Khusus</option>
                        </select>
                    </div>
                    <div class="col-md-6">
                        <label class="label-tanya text-muted small">KESIAPAN HADIR (DARURAT)</label>
                        <select id="hadir" class="form-select" required>
                            <option value="Ya">Siap Hadir (1x24 Jam)</option>
                            <option value="Tidak">Sulit Hadir / Jauh</option>
                        </select>
                    </div>
                </div>

                <div class="mt-3">
                    <label class="label-tanya text-danger">Jika anak dihukum karena melanggar, sikap Bapak/Ibu?</label>
                    <select id="sikap" class="form-select border-danger" required>
                        <option value="" disabled selected>-- Pilih Sikap Jujur --</option>
                        <option value="Tabayyun">Konfirmasi dulu (Tabayyun)</option>
                        <option value="Pasrah">Pasrah pada kebijakan Pesantren</option>
                        <option value="Protes">Tidak Terima / Protes</option>
                    </select>
                </div>
            </div>

            <div class="card bg-light border-0 mb-4">
                <div class="card-body">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" required id="agree" style="transform: scale(1.2);">
                        <label class="form-check-label ms-2" for="agree">
                            <b>Saya menyatakan data di atas adalah benar.</b> Saya menyerahkan anak saya kepada Pesantren.
                        </label>
                    </div>
                </div>
            </div>

            <div class="d-grid gap-2">
                <button type="submit" class="btn btn-submit text-white btn-lg">
                    <i class="bi bi-send-check-fill me-2"></i> KIRIM KOMITMEN
                </button>
                <a href="index.html" class="btn btn-outline-secondary border-0 mt-2">Kembali ke Halaman Utama</a>
            </div>

        </form>
    </div>

<script type="module">
    import { db, collection, addDoc, serverTimestamp } from './config.js';

    document.getElementById('formWali').addEventListener('submit', async (e) => {
        e.preventDefault();
        const btn = e.target.querySelector('button[type="submit"]');
        const originalText = btn.innerHTML;

        btn.disabled = true;
        btn.innerHTML = '<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Sedang Mengirim...';

        try {
            await addDoc(collection(db, "wali_santri"), {
                namaWali: document.getElementById('namaWali').value,
                namaAnak: document.getElementById('namaAnak').value,
                waWali: document.getElementById('waWali').value,
                penyakit: document.getElementById('penyakit').value,
                pelanggaran: document.getElementById('pelanggaran').value,
                motivasi_utama: document.querySelector('input[name="motivasiWali"]:checked').value,
                tanggungjawab_keuangan: document.getElementById('keuangan').value,
                respon_disiplin: document.getElementById('sikap').value,
                tanggungjawab_hadir: document.getElementById('hadir').value,
                waktu_isi: serverTimestamp()
            });

            alert("Terima Kasih, Data Wali Berhasil Disimpan!");
            window.location.href = "index.html";
        } catch (error) {
            console.error(error);
            alert("Gagal: " + error.message);
            btn.disabled = false;
            btn.innerHTML = originalText;
        }
    });
</script>
</body>
</html>
